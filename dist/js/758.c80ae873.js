"use strict";(self["webpackChunkpopcorn_vue"]=self["webpackChunkpopcorn_vue"]||[]).push([[758],{4677:function(t,e,o){var a=o(3766),r=o(6265),s=o.n(r),d=o(6294);e["Z"]=(0,a.Q_)("cartStore",{state:()=>({cart:{},cartLen:0,coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""}},order:{user:{}},orderId:""}),actions:{plus(t){t.qty+=1,this.updateCart(t)},minus(t){t.qty>1&&(t.qty-=1,this.updateCart(t))},getCart(){const t=(0,d.Z)(),e="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart";t.isLoading=!0,s().get(e).then((e=>{this.cart=e.data.data,this.cartLen=e.data.data.carts.length,t.isLoading=!1}))},addCart(t){const e=(0,d.Z)(),o="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart",a={product_id:t,qty:1};e.loadingItem=t,s().post(o,{data:a}).then((t=>{e.loadingItem="",e.pushMessage({title:"加入購物車"}),this.getCart()}))},updateCart(t){const e=(0,d.Z)(),o=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${t.id}`;e.loadingItem=id;const a={product_id:t.product_id,qty:t.qty};s().put(o,{data:a}).then((t=>{this.getCart(),e.loadingItem=""}))},removeCartItem(t){const e=(0,d.Z)(),o=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${t}`;e.isLoading=!0,e.loadingItem=t,s()["delete"](o).then((t=>{e.pushMessage({title:"移除購物車"}),e.loadingItem="",this.getCart(),e.isLoading=!1}))},addCouponCode(){const t=(0,d.Z)(),e="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/coupon";t.isLoading=!0;const o={code:this.coupon_code};s().post(e,{data:o}).then((e=>{t.pushMessage({title:"加入優惠券"}),this.getCart(),t.isLoading=!1}))},createOrder(){const t=(0,d.Z)(),e="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/order",o=this.form;t.isLoading=!0,s().post(e,{data:o}).then((e=>{t.pushMessage({title:"送出訂單"});const o=e.data.orderId;t.isLoading=!1,this.$router.push(`./checkout/${o}`)}))},getOrder(){const t=(0,d.Z)(),e=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/order/${this.orderId}`;t.isLoading=!0,s().get(e).then((e=>{e.data.success&&(this.order=e.data.order,t.isLoading=!1)}))},payOrder(){const t=(0,d.Z)(),e=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/pay/${this.orderId}`;t.isLoading=!0,s().post(e).then((e=>{e.data.success&&(this.getOrder(),t.isLoading=!1)}))}}})},2758:function(t,e,o){o.r(e),o.d(e,{default:function(){return W}});var a=o(3396),r=o(9242),s=o(7139);const d=t=>((0,a.dD)("data-v-d0342edc"),t=t(),(0,a.Cn)(),t),i={class:"wrap"},n={class:"cart-container"},c=d((()=>(0,a._)("h2",null,"填寫資料",-1))),l=d((()=>(0,a._)("ul",null,[(0,a._)("li",null,[(0,a.Uk)("Step1"),(0,a._)("br"),(0,a.Uk)("購物內容")]),(0,a._)("li",null,[(0,a.Uk)("Step2"),(0,a._)("br"),(0,a.Uk)("填寫資料")]),(0,a._)("li",null,[(0,a.Uk)("Step3"),(0,a._)("br"),(0,a.Uk)("完成訂單")])],-1))),u={class:"check"},p={class:"cart"},h=d((()=>(0,a._)("h3",null,"購物清單",-1))),_={class:"cart-box"},g={class:"cart"},v=d((()=>(0,a._)("h3",null,"訂購資料",-1))),k={class:"cart-box"},y=d((()=>(0,a._)("td",null,"訂購姓名：",-1))),m={colspan:"2"},w=d((()=>(0,a._)("td",null,"訂購信箱：",-1))),L={colspan:"2"},C=d((()=>(0,a._)("td",null,"聯絡電話：",-1))),I={colspan:"2"},Z=d((()=>(0,a._)("td",null,"收件地址：",-1))),f={colspan:"2"},b=d((()=>(0,a._)("td",null,"付款狀態：",-1))),x={colspan:"2"},z={key:0},O={key:1,class:"text-success"},$={key:0,class:"cart-footer"},q=d((()=>(0,a._)("button",{class:"check-out"},"立即付款",-1))),D=[q];function U(t,e,o,d,q,U){const M=(0,a.up)("Loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(M,{active:t.isLoading},null,8,["active"]),(0,a._)("div",i,[(0,a._)("div",n,[c,l,(0,a._)("div",u,[(0,a._)("form",{onSubmit:e[0]||(e[0]=(0,r.iM)(((...e)=>t.payOrder&&t.payOrder(...e)),["prevent"]))},[(0,a._)("div",p,[h,(0,a._)("div",_,[(0,a._)("table",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.order.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,(0,s.zw)(t.product.title),1),(0,a._)("td",null,(0,s.zw)(t.qty)+"/"+(0,s.zw)(t.product.unit),1),(0,a._)("td",null,"$"+(0,s.zw)(t.final_total)+"元",1)])))),128))])]),(0,a._)("h3",null,"總計：$"+(0,s.zw)(t.order.total)+"元",1)]),(0,a._)("div",g,[v,(0,a._)("div",k,[(0,a._)("table",null,[(0,a._)("tr",null,[y,(0,a._)("td",m,(0,s.zw)(t.order.user.name),1)]),(0,a._)("tr",null,[w,(0,a._)("td",L,(0,s.zw)(t.order.user.email),1)]),(0,a._)("tr",null,[C,(0,a._)("td",I,(0,s.zw)(t.order.user.tel),1)]),(0,a._)("tr",null,[Z,(0,a._)("td",f,(0,s.zw)(t.order.user.address),1)]),(0,a._)("tr",null,[b,(0,a._)("td",x,[t.order.is_paid?((0,a.wg)(),(0,a.iD)("span",O,"付款完成")):((0,a.wg)(),(0,a.iD)("span",z,"尚未付款"))])])])]),!1===t.order.is_paid?((0,a.wg)(),(0,a.iD)("div",$,D)):(0,a.kq)("",!0)])],32)])])])],64)}var M=o(3766),S=o(6294),H=o(4677),Y={computed:{...(0,M.rn)(S.Z,["isLoading"]),...(0,M.rn)(H.Z,["order","orderId"])},methods:{...(0,M.nv)(H.Z,["getOrder","payOrder"])},created(){this.orderId=this.$route.params.orderId,this.getOrder()}},K=o(89);const Q=(0,K.Z)(Y,[["render",U],["__scopeId","data-v-d0342edc"]]);var W=Q}}]);
//# sourceMappingURL=758.c80ae873.js.map