"use strict";(self["webpackChunkpopcorn_vue"]=self["webpackChunkpopcorn_vue"]||[]).push([[100],{4677:function(e,a,t){var o=t(3766),s=t(6265),l=t.n(s),r=t(6294);a["Z"]=(0,o.Q_)("cartStore",{state:()=>({cart:{},cartLen:0,coupon_code:"",form:{user:{name:"",email:"",tel:"",address:""}},order:{user:{}},orderId:""}),actions:{plus(e){e.qty+=1,this.updateCart(e)},minus(e){e.qty>1&&(e.qty-=1,this.updateCart(e))},getCart(){const e=(0,r.Z)(),a="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart";e.isLoading=!0,l().get(a).then((a=>{this.cart=a.data.data,this.cartLen=a.data.data.carts.length,e.isLoading=!1}))},addCart(e){const a=(0,r.Z)(),t="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart",o={product_id:e,qty:1};a.loadingItem=e,l().post(t,{data:o}).then((e=>{a.loadingItem="",a.pushMessage({title:"加入購物車"}),this.getCart()}))},updateCart(e){const a=(0,r.Z)(),t=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${e.id}`;a.loadingItem=id;const o={product_id:e.product_id,qty:e.qty};l().put(t,{data:o}).then((e=>{this.getCart(),a.loadingItem=""}))},removeCartItem(e){const a=(0,r.Z)(),t=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${e}`;a.isLoading=!0,a.loadingItem=e,l()["delete"](t).then((e=>{a.pushMessage({title:"移除購物車"}),a.loadingItem="",this.getCart(),a.isLoading=!1}))},addCouponCode(){const e=(0,r.Z)(),a="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/coupon";e.isLoading=!0;const t={code:this.coupon_code};l().post(a,{data:t}).then((a=>{e.pushMessage({title:"加入優惠券"}),this.getCart(),e.isLoading=!1}))},createOrder(){const e=(0,r.Z)(),a="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/order",t=this.form;e.isLoading=!0,l().post(a,{data:t}).then((a=>{e.pushMessage({title:"送出訂單"});const t=a.data.orderId;e.isLoading=!1,this.$router.push(`./checkout/${t}`)}))},getOrder(){const e=(0,r.Z)(),a=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/order/${this.orderId}`;e.isLoading=!0,l().get(a).then((a=>{a.data.success&&(this.order=a.data.order,e.isLoading=!1)}))},payOrder(){const e=(0,r.Z)(),a=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/pay/${this.orderId}`;e.isLoading=!0,l().post(a).then((a=>{a.data.success&&(this.getOrder(),e.isLoading=!1)}))}}})},2100:function(e,a,t){t.r(a),t.d(a,{default:function(){return D}});var o=t(3396),s=t(7139),l=t(9242);const r=e=>((0,o.dD)("data-v-7c4fc708"),e=e(),(0,o.Cn)(),e),i={class:"wrap"},c={class:"cart-container"},d=r((()=>(0,o._)("h2",null,"填寫資料",-1))),n=r((()=>(0,o._)("ul",null,[(0,o._)("li",null,[(0,o.Uk)("Step1"),(0,o._)("br"),(0,o.Uk)("購物內容")]),(0,o._)("li",null,[(0,o.Uk)("Step2"),(0,o._)("br"),(0,o.Uk)("填寫資料")]),(0,o._)("li",null,[(0,o.Uk)("Step3"),(0,o._)("br"),(0,o.Uk)("完成訂單")])],-1))),u={class:"check"},p={class:"cart"},m=r((()=>(0,o._)("h3",null,"購物清單",-1))),h={class:"form"},f=r((()=>(0,o._)("h3",null,"訂單資料",-1))),_={class:"form-box"},g=r((()=>(0,o._)("label",{for:"name",class:"form-label"},"收件人姓名",-1))),v={class:"form-box"},b=r((()=>(0,o._)("label",{for:"email",class:"form-label"},"Email",-1))),k={class:"form-box"},y=r((()=>(0,o._)("label",{for:"tel",class:"form-label"},"收件人電話",-1))),C={class:"form-box"},x=r((()=>(0,o._)("label",{for:"address",class:"form-label"},"收件人地址",-1))),L={class:"form-box"},w=r((()=>(0,o._)("label",{for:"message",class:"form-label"},"留言",-1))),Z={class:"cart-footer"},V=(0,o.Uk)("修改購物車"),I=r((()=>(0,o._)("button",{class:"check-out"},"送出訂單",-1)));function U(e,a,t,r,U,q){const W=(0,o.up)("Loading"),$=(0,o.up)("Field"),O=(0,o.up)("ErrorMessage"),S=(0,o.up)("router-link"),z=(0,o.up)("Form");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(W,{active:e.isLoading},null,8,["active"]),(0,o._)("div",i,[(0,o._)("div",c,[d,n,(0,o._)("div",u,[(0,o._)("div",p,[m,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.cart.carts,(a=>((0,o.wg)(),(0,o.iD)("div",{class:"cart-box",key:a.id},[(0,o._)("table",null,[(0,o._)("tr",null,[(0,o._)("td",null,(0,s.zw)(a.product.title),1),(0,o._)("td",null,(0,s.zw)(a.qty)+" / "+(0,s.zw)(a.product.unit),1),(0,o._)("td",null,"$"+(0,s.zw)(e.$filters.currency(a.final_total)),1)])])])))),128)),(0,o._)("h3",null,"總計：$"+(0,s.zw)(e.$filters.currency(e.cart.final_total))+"元",1)]),(0,o._)("div",h,[f,(0,o.Wm)(z,{onSubmit:e.createOrder},{default:(0,o.w5)((({errors:t})=>[(0,o._)("div",_,[g,(0,o.Wm)($,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:e.form.user.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.form.user.name=a)},null,8,["class","modelValue"]),(0,o.Wm)(O,{name:"姓名",class:"invalid-feedback"})]),(0,o._)("div",v,[b,(0,o.Wm)($,{id:"email",name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:e.form.user.email,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.user.email=a)},null,8,["class","modelValue"]),(0,o.Wm)(O,{name:"email",class:"invalid-feedback"})]),(0,o._)("div",k,[y,(0,o.Wm)($,{id:"tel",name:"電話",type:"tel",class:(0,s.C_)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:e.form.user.tel,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.user.tel=a)},null,8,["class","modelValue"]),(0,o.Wm)(O,{name:"電話",class:"invalid-feedback"})]),(0,o._)("div",C,[x,(0,o.Wm)($,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:e.form.user.address,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.user.address=a)},null,8,["class","modelValue"]),(0,o.Wm)(O,{name:"地址",class:"invalid-feedback"})]),(0,o._)("div",L,[w,(0,o.wy)((0,o._)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":a[4]||(a[4]=a=>e.form.message=a)},null,512),[[l.nr,e.form.message]])]),(0,o._)("div",Z,[(0,o.Wm)(S,{to:"/final/cart"},{default:(0,o.w5)((()=>[V])),_:1}),I])])),_:1},8,["onSubmit"])])])])])],64)}var q=t(3766),W=t(4238),$=t(6294),O=t(4677),S={computed:{...(0,q.rn)(W.Z,["products","product"]),...(0,q.rn)($.Z,["isLoading"]),...(0,q.rn)(O.Z,["cart","form"])},methods:{...(0,q.nv)(W.Z,["getProducts"]),...(0,q.nv)(O.Z,["getCart","createOrder"])},created(){this.getProducts(),this.getCart()}},z=t(89);const M=(0,z.Z)(S,[["render",U],["__scopeId","data-v-7c4fc708"]]);var D=M}}]);
//# sourceMappingURL=100.60437909.js.map