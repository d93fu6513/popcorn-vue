{"version":3,"file":"js/758.c80ae873.js","mappings":"gKAIA,QAAeA,EAAAA,EAAAA,IAAY,YAAa,CACpCC,MAAO,KAAM,CACTC,KAAM,GACNC,QAAS,EACTC,YAAa,GACbC,KAAM,CACFC,KAAM,CACFC,KAAM,GACNC,MAAO,GACPC,IAAK,GACLC,QAAS,KAGjBC,MAAO,CACHL,KAAM,IAEVM,QAAS,KAEbC,QAAS,CACLC,KAAKC,GACDA,EAAKC,KAAO,EACZC,KAAKC,WAAWH,IAElBI,MAAMJ,GACAA,EAAKC,IAAM,IACbD,EAAKC,KAAO,EACZC,KAAKC,WAAWH,KAGtBK,UACI,MAAMC,GAASC,EAAAA,EAAAA,KACTC,EAAO,iEACbF,EAAOG,WAAY,EACnBC,IAAAA,IAAUF,GAAKG,MAAMC,IACjBV,KAAKf,KAAOyB,EAAIC,KAAKA,KACrBX,KAAKd,QAAUwB,EAAIC,KAAKA,KAAKC,MAAMC,OACnCT,EAAOG,WAAY,MAG3BO,QAAQC,GACJ,MAAMX,GAASC,EAAAA,EAAAA,KACTC,EAAO,iEACPrB,EAAO,CACT+B,WAAYD,EACZhB,IAAK,GAETK,EAAOa,YAAcF,EACrBP,IAAAA,KAAWF,EAAK,CAAEK,KAAM1B,IAAQwB,MAAMC,IAClCN,EAAOa,YAAc,GACrBb,EAAOc,YAAY,CAAEC,MAAO,UAC5BnB,KAAKG,cAGbF,WAAWH,GACP,MAAMM,GAASC,EAAAA,EAAAA,KACTC,EAAO,kEAAiER,EAAKiB,KAEnFX,EAAOa,YAAcF,GACrB,MAAM9B,EAAO,CACT+B,WAAYlB,EAAKkB,WACjBjB,IAAKD,EAAKC,KAEdS,IAAAA,IAAUF,EAAK,CAAEK,KAAM1B,IAAQwB,MAAMC,IACjCV,KAAKG,UACLC,EAAOa,YAAc,OAI7BG,eAAeL,GACX,MAAMX,GAASC,EAAAA,EAAAA,KACTC,EAAO,kEAAiES,IAC9EX,EAAOG,WAAY,EACnBH,EAAOa,YAAcF,EACrBP,IAAAA,UAAaF,GAAKG,MAAMC,IACpBN,EAAOc,YAAY,CAAEC,MAAO,UAC5Bf,EAAOa,YAAc,GACrBjB,KAAKG,UACLC,EAAOG,WAAY,MAG3Bc,gBACI,MAAMjB,GAASC,EAAAA,EAAAA,KACTC,EAAO,mEACbF,EAAOG,WAAY,EACnB,MAAMe,EAAS,CACXC,KAAMvB,KAAKb,aAEfqB,IAAAA,KAAWF,EAAK,CAAEK,KAAMW,IAAUb,MAAMe,IACpCpB,EAAOc,YAAY,CAAEC,MAAO,UAC5BnB,KAAKG,UACLC,EAAOG,WAAY,MAG3BkB,cACI,MAAMrB,GAASC,EAAAA,EAAAA,KACTC,EAAO,kEACPZ,EAAQM,KAAKZ,KACnBgB,EAAOG,WAAY,EACnBC,IAAAA,KAAWF,EAAK,CAAEK,KAAMjB,IAASe,MAAMC,IACnCN,EAAOc,YAAY,CAAEC,MAAO,SAC5B,MAAMxB,EAAUe,EAAIC,KAAKhB,QACzBS,EAAOG,WAAY,EACnBP,KAAK0B,QAAQC,KAAM,cAAahC,SAGxCiC,WACI,MAAMxB,GAASC,EAAAA,EAAAA,KACTC,EAAO,mEAAkEN,KAAKL,UACpFS,EAAOG,WAAY,EACnBC,IAAAA,IAAUF,GAAKG,MAAMC,IACbA,EAAIC,KAAKkB,UACT7B,KAAKN,MAAQgB,EAAIC,KAAKjB,MACtBU,EAAOG,WAAY,OAI/BuB,WACI,MAAM1B,GAASC,EAAAA,EAAAA,KACTC,EAAO,iEAAgEN,KAAKL,UAClFS,EAAOG,WAAY,EACnBC,IAAAA,KAAWF,GAAKG,MAAMC,IACdA,EAAIC,KAAKkB,UACT7B,KAAK4B,WACLxB,EAAOG,WAAY,W,mKC7HhCwB,MAAM,Q,GACJA,MAAM,kB,UACTC,EAAAA,EAAAA,GAAa,UAAT,QAAI,K,UACRA,EAAAA,EAAAA,GAIK,YAHHA,EAAAA,EAAAA,GAAwB,oBAApB,UAAKA,EAAAA,EAAAA,GAAM,OAAS,QAAT,WACfA,EAAAA,EAAAA,GAAwB,oBAApB,UAAKA,EAAAA,EAAAA,GAAM,OAAS,QAAT,WACfA,EAAAA,EAAAA,GAAwB,oBAApB,UAAKA,EAAAA,EAAAA,GAAM,OAAS,QAAT,YAHjB,K,GAKKD,MAAM,S,GAEFA,MAAM,Q,UACTC,EAAAA,EAAAA,GAAa,UAAT,QAAI,K,GACHD,MAAM,Y,GAWRA,MAAM,Q,UACTC,EAAAA,EAAAA,GAAa,UAAT,QAAI,K,GACHD,MAAM,Y,UAGLC,EAAAA,EAAAA,GAAc,UAAV,SAAK,K,GACLC,QAAQ,K,UAGZD,EAAAA,EAAAA,GAAc,UAAV,SAAK,K,GACLC,QAAQ,K,UAGZD,EAAAA,EAAAA,GAAc,UAAV,SAAK,K,GACLC,QAAQ,K,UAGZD,EAAAA,EAAAA,GAAc,UAAV,SAAK,K,GACLC,QAAQ,K,UAGZD,EAAAA,EAAAA,GAAc,UAAV,SAAK,K,GACLC,QAAQ,K,mBAEGF,MAAM,gB,SAKtBA,MAAM,e,UACTC,EAAAA,EAAAA,GAAuC,UAA/BD,MAAM,aAAY,QAAI,K,GAA9BG,G,0FAtDZC,EAAAA,EAAAA,IAAuCC,EAAA,CAA7BC,OAAQC,EAAAA,WAAS,oBAC3BN,EAAAA,EAAAA,GA2DM,MA3DN,EA2DM,EA1DJA,EAAAA,EAAAA,GAyDM,MAzDN,EAyDM,CAxDJO,EACAC,GAKAR,EAAAA,EAAAA,GAiDM,MAjDN,EAiDM,EAhDJA,EAAAA,EAAAA,GA+CO,QA/CAS,SAAM,8BAAUH,EAAAA,UAAAA,EAAAA,YAAAA,IAAQ,eAA/B,EACEN,EAAAA,EAAAA,GAYM,MAZN,EAYM,CAXJU,GACAV,EAAAA,EAAAA,GAQM,MARN,EAQM,EAPJA,EAAAA,EAAAA,GAMQ,6BALNW,EAAAA,EAAAA,IAIKC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAJcP,EAAAA,MAAMQ,UAAdhD,K,WAAX6C,EAAAA,EAAAA,IAIK,MAJ+BI,IAAKjD,EAAKiB,IAA9C,EACEiB,EAAAA,EAAAA,GAAiC,WAAAgB,EAAAA,EAAAA,IAA1BlD,EAAKmD,QAAQ9B,OAAK,IACzBa,EAAAA,EAAAA,GAA+C,WAAAgB,EAAAA,EAAAA,IAAxClD,EAAKC,KAAM,KAACiD,EAAAA,EAAAA,IAAGlD,EAAKmD,QAAQC,MAAI,IACvClB,EAAAA,EAAAA,GAAiC,UAA7B,KAACgB,EAAAA,EAAAA,IAAGlD,EAAKqD,aAAc,IAAC,QAH9B,WAOJnB,EAAAA,EAAAA,GAA+B,UAA3B,QAAIgB,EAAAA,EAAAA,IAAGV,EAAAA,MAAMc,OAAQ,IAAC,MAE5BpB,EAAAA,EAAAA,GAgCM,MAhCN,EAgCM,CA/BJqB,GACArB,EAAAA,EAAAA,GA0BM,MA1BN,EA0BM,EAzBJA,EAAAA,EAAAA,GAwBQ,eAvBNA,EAAAA,EAAAA,GAGK,WAFHsB,GACAtB,EAAAA,EAAAA,GAA0C,KAA1C,GAA0CgB,EAAAA,EAAAA,IAAvBV,EAAAA,MAAMjD,KAAKC,MAAI,MAEpC0C,EAAAA,EAAAA,GAGK,WAFHuB,GACAvB,EAAAA,EAAAA,GAA2C,KAA3C,GAA2CgB,EAAAA,EAAAA,IAAxBV,EAAAA,MAAMjD,KAAKE,OAAK,MAErCyC,EAAAA,EAAAA,GAGK,WAFHwB,GACAxB,EAAAA,EAAAA,GAAyC,KAAzC,GAAyCgB,EAAAA,EAAAA,IAAtBV,EAAAA,MAAMjD,KAAKG,KAAG,MAEnCwC,EAAAA,EAAAA,GAGK,WAFHyB,GACAzB,EAAAA,EAAAA,GAA6C,KAA7C,GAA6CgB,EAAAA,EAAAA,IAA1BV,EAAAA,MAAMjD,KAAKI,SAAO,MAEvCuC,EAAAA,EAAAA,GAMK,WALH0B,GACA1B,EAAAA,EAAAA,GAGK,KAHL,EAGK,CAFUM,EAAAA,MAAMqB,UAAnB,WACAhB,EAAAA,EAAAA,IAA6C,OAA7C,EAAkC,WADfgB,EAAAA,EAAAA,OAAnBhB,EAAAA,EAAAA,IAAuC,OAAAiB,EAAX,kBAMQ,IAAbtB,EAAAA,MAAMqB,UAAO,WAA5ChB,EAAAA,EAAAA,IAEM,MAFN,EAEMkB,KAFN,kBA3CJ,WATN,I,kCAmEF,GACEC,SAAU,KACLC,EAAAA,EAAAA,IAAS1D,EAAAA,EAAa,CAAC,kBACvB0D,EAAAA,EAAAA,IAASC,EAAAA,EAAW,CAAC,QAAS,aAEnCC,QAAS,KACJC,EAAAA,EAAAA,IAAWF,EAAAA,EAAW,CAAC,WAAY,cAExCG,UACEnE,KAAKL,QAAUK,KAAKoE,OAAOC,OAAO1E,QAClCK,KAAK4B,a,QCxET,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF","sources":["webpack://popcorn-vue/./src/stores/cartStore.js","webpack://popcorn-vue/./src/views/FinalCheckOut.vue","webpack://popcorn-vue/./src/views/FinalCheckOut.vue?666e"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport axios from \"axios\";\r\nimport statusStore from \"./statusStore\";\r\n\r\nexport default defineStore('cartStore', {\r\n    state: () => ({\r\n        cart: {},\r\n        cartLen: 0,\r\n        coupon_code: '',\r\n        form: {\r\n            user: {\r\n                name: \"\",\r\n                email: \"\",\r\n                tel: \"\",\r\n                address: \"\",\r\n            },\r\n        },\r\n        order: {\r\n            user: {},\r\n        },\r\n        orderId: \"\",\r\n    }),\r\n    actions: {\r\n        plus(item) {\r\n            item.qty += 1;\r\n            this.updateCart(item);\r\n          },\r\n          minus(item) {\r\n            if (item.qty > 1) {\r\n              item.qty -= 1;\r\n              this.updateCart(item);\r\n            }\r\n          },\r\n        getCart() {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\r\n            status.isLoading = true;\r\n            axios.get(url).then((res) => {\r\n                this.cart = res.data.data;\r\n                this.cartLen = res.data.data.carts.length;\r\n                status.isLoading = false;\r\n            });\r\n        },\r\n        addCart(id) {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\r\n            const cart = {\r\n                product_id: id,\r\n                qty: 1,\r\n            };\r\n            status.loadingItem = id;\r\n            axios.post(url, { data: cart }).then((res) => {\r\n                status.loadingItem = \"\";\r\n                status.pushMessage({ title: '加入購物車' });\r\n                this.getCart();\r\n            });\r\n        },\r\n        updateCart(item) {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\r\n            \r\n            status.loadingItem = id;\r\n            const cart = {\r\n                product_id: item.product_id,\r\n                qty: item.qty,\r\n            };\r\n            axios.put(url, { data: cart }).then((res) => {\r\n                this.getCart();\r\n                status.loadingItem = \"\";\r\n                \r\n            });\r\n        },\r\n        removeCartItem(id) {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${id}`;\r\n            status.isLoading = true;\r\n            status.loadingItem = id;\r\n            axios.delete(url).then((res) => {\r\n                status.pushMessage({ title: '移除購物車' });\r\n                status.loadingItem = \"\";\r\n                this.getCart();\r\n                status.isLoading = false;\r\n            });\r\n        },\r\n        addCouponCode() {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\r\n            status.isLoading = true;\r\n            const coupon = {\r\n                code: this.coupon_code,\r\n            };\r\n            axios.post(url, { data: coupon }).then((response) => {\r\n                status.pushMessage({ title: '加入優惠券' });\r\n                this.getCart();\r\n                status.isLoading = false;\r\n            });\r\n        },\r\n        createOrder() {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order`;\r\n            const order = this.form;\r\n            status.isLoading = true;\r\n            axios.post(url, { data: order }).then((res) => {\r\n                status.pushMessage({ title: '送出訂單' });\r\n                const orderId = res.data.orderId;\r\n                status.isLoading = false;\r\n                this.$router.push(`./checkout/${orderId}`);\r\n            });\r\n        },\r\n        getOrder() {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/order/${this.orderId}`;\r\n            status.isLoading = true;\r\n            axios.get(url).then((res) => {\r\n                if (res.data.success) {\r\n                    this.order = res.data.order;\r\n                    status.isLoading = false;\r\n                }\r\n            });\r\n        },\r\n        payOrder() {\r\n            const status = statusStore();\r\n            const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/pay/${this.orderId}`;\r\n            status.isLoading = true;\r\n            axios.post(url).then((res) => {\r\n                if (res.data.success) {\r\n                    this.getOrder();\r\n                    status.isLoading = false;\r\n                }\r\n            });\r\n        },\r\n    },\r\n})","<template>\r\n  <Loading :active=\"isLoading\"></Loading>\r\n  <div class=\"wrap\">\r\n    <div class=\"cart-container\">\r\n      <h2>填寫資料</h2>\r\n      <ul>\r\n        <li>Step1<br />購物內容</li>\r\n        <li>Step2<br />填寫資料</li>\r\n        <li>Step3<br />完成訂單</li>\r\n      </ul>\r\n      <div class=\"check\">\r\n        <form @submit.prevent=\"payOrder\">\r\n          <div class=\"cart\">\r\n            <h3>購物清單</h3>\r\n            <div class=\"cart-box\">\r\n              <table>\r\n                <tr v-for=\"item in order.products\" :key=\"item.id\">\r\n                  <td>{{ item.product.title }}</td>\r\n                  <td>{{ item.qty }}/{{ item.product.unit }}</td>\r\n                  <td>${{ item.final_total }}元</td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <h3>總計：${{ order.total }}元</h3>\r\n          </div>\r\n          <div class=\"cart\">\r\n            <h3>訂購資料</h3>\r\n            <div class=\"cart-box\">\r\n              <table>\r\n                <tr>\r\n                  <td>訂購姓名：</td>\r\n                  <td colspan=\"2\">{{ order.user.name }}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>訂購信箱：</td>\r\n                  <td colspan=\"2\">{{ order.user.email }}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>聯絡電話：</td>\r\n                  <td colspan=\"2\">{{ order.user.tel }}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>收件地址：</td>\r\n                  <td colspan=\"2\">{{ order.user.address }}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>付款狀態：</td>\r\n                  <td colspan=\"2\">\r\n                    <span v-if=\"!order.is_paid\">尚未付款</span>\r\n                    <span v-else class=\"text-success\">付款完成</span>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </div>\r\n            <div class=\"cart-footer\" v-if=\"order.is_paid === false\">\r\n              <button class=\"check-out\">立即付款</button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapActions } from \"pinia\";\r\nimport statusStore from \"@/stores/statusStore\";\r\nimport cartStore from \"@/stores/cartStore\";\r\n\r\nexport default {\r\n  computed: {\r\n    ...mapState(statusStore, ['isLoading']),\r\n    ...mapState(cartStore, ['order', 'orderId']),\r\n  },\r\n  methods: {\r\n    ...mapActions(cartStore, ['getOrder', 'payOrder']),\r\n  },\r\n  created() {\r\n    this.orderId = this.$route.params.orderId;\r\n    this.getOrder();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"@/assets/css/viewsScss/_finalcheckout\";\r\n</style>","import { render } from \"./FinalCheckOut.vue?vue&type=template&id=d0342edc&scoped=true\"\nimport script from \"./FinalCheckOut.vue?vue&type=script&lang=js\"\nexport * from \"./FinalCheckOut.vue?vue&type=script&lang=js\"\n\nimport \"./FinalCheckOut.vue?vue&type=style&index=0&id=d0342edc&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\d93fu\\\\Desktop\\\\popcorn-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-d0342edc\"]])\n\nexport default __exports__"],"names":["defineStore","state","cart","cartLen","coupon_code","form","user","name","email","tel","address","order","orderId","actions","plus","item","qty","this","updateCart","minus","getCart","status","statusStore","url","isLoading","axios","then","res","data","carts","length","addCart","id","product_id","loadingItem","pushMessage","title","removeCartItem","addCouponCode","coupon","code","response","createOrder","$router","push","getOrder","success","payOrder","class","_createElementVNode","colspan","_hoisted_25","_createVNode","_component_Loading","active","_ctx","_hoisted_3","_hoisted_4","onSubmit","_hoisted_7","_createElementBlock","_Fragment","_renderList","products","key","_toDisplayString","product","unit","final_total","total","_hoisted_10","_hoisted_12","_hoisted_14","_hoisted_16","_hoisted_18","_hoisted_20","is_paid","_hoisted_22","_hoisted_26","computed","mapState","cartStore","methods","mapActions","created","$route","params","__exports__","render"],"sourceRoot":""}