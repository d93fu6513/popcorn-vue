"use strict";(self["webpackChunkpopcorn_vue"]=self["webpackChunkpopcorn_vue"]||[]).push([[463],{5463:function(t,o,a){a.r(o),a.d(o,{default:function(){return S}});var i=a(3396),s=a(7139),e=a(9242);const n=t=>((0,i.dD)("data-v-55709c87"),t=t(),(0,i.Cn)(),t),c={class:"wrap"},l={class:"cart-container"},u=n((()=>(0,i._)("h2",null,"購物車",-1))),r=n((()=>(0,i._)("ul",null,[(0,i._)("li",null,[(0,i.Uk)("Step1"),(0,i._)("br"),(0,i.Uk)("購物內容")]),(0,i._)("li",null,[(0,i.Uk)("Step2"),(0,i._)("br"),(0,i.Uk)("填寫資料")]),(0,i._)("li",null,[(0,i.Uk)("Step3"),(0,i._)("br"),(0,i.Uk)("完成訂單")])],-1))),d={class:"cart-body"},p=["src"],h=n((()=>(0,i._)("br",null,null,-1))),_={key:0},g={class:"count"},k=["onClick"],m=["onUpdate:modelValue","onChange"],C=["onClick"],y={key:0},v=["disabled","onClick"],f={class:"box-footer"},w={class:"coupon"},b={class:"price"},$={key:0},U={class:"cart-footer"},q=(0,i.Uk)("繼續購物"),x=(0,i.Uk)("下一步");function I(t,o,a,n,I,L){const D=(0,i.up)("font-awesome-icon"),z=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("div",l,[u,r,(0,i._)("div",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(I.cart.carts,(o=>((0,i.wg)(),(0,i.iD)("div",{class:"box",key:o.id},[(0,i._)("img",{src:o.product.imageUrl,alt:""},null,8,p),(0,i._)("h3",null,[(0,i.Uk)((0,s.zw)(o.product.title),1),h,o.coupon?((0,i.wg)(),(0,i.iD)("small",_,"已套用優惠券")):(0,i.kq)("",!0)]),(0,i._)("div",g,[(0,i._)("button",{onClick:t=>L.minus(o)},[(0,i.Wm)(D,{icon:["fas","minus"]})],8,k),(0,i.wy)((0,i._)("input",{type:"number",min:"1","onUpdate:modelValue":t=>o.qty=t,onChange:t=>L.updateCart(o)},null,40,m),[[e.nr,o.qty,void 0,{number:!0}]]),(0,i._)("button",{onClick:t=>L.plus(o)},[(0,i.Wm)(D,{icon:["fas","plus"]})],8,C)]),(0,i._)("h4",null,"$"+(0,s.zw)(o.product.price)+"元 / "+(0,s.zw)(o.product.unit),1),(0,i._)("h4",null,[I.cart.final_total!==I.cart.total?((0,i.wg)(),(0,i.iD)("small",y,"折扣價：")):(0,i.kq)("",!0),(0,i.Uk)(" $"+(0,s.zw)(t.$filters.currency(o.final_total))+"元 ",1)]),(0,i._)("button",{type:"button",class:"cart-del",disabled:I.status.loadingItem===o.id,onClick:t=>L.removeCartItem(o.id)},[(0,i.Wm)(D,{icon:["fas","trash-can"]})],8,v)])))),128)),(0,i._)("div",f,[(0,i._)("div",w,[(0,i.wy)((0,i._)("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=t=>I.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[e.nr,I.coupon_code]]),(0,i._)("button",{type:"button",onClick:o[1]||(o[1]=t=>L.addCouponCode())},"套用優惠碼")]),(0,i._)("div",b,[(0,i._)("h5",null,"總計：$"+(0,s.zw)(t.$filters.currency(I.cart.total))+"元",1),I.cart.final_total!==I.cart.total?((0,i.wg)(),(0,i.iD)("strong",$," 折扣價：$"+(0,s.zw)(t.$filters.currency(I.cart.final_total))+"元 ",1)):(0,i.kq)("",!0)])]),(0,i._)("div",U,[(0,i.Wm)(z,{to:"/product/index"},{default:(0,i.w5)((()=>[q])),_:1}),(0,i.Wm)(z,{to:"/final/check"},{default:(0,i.w5)((()=>[x])),_:1})])])])])}var L={data(){return{products:[],product:{},status:{loadingItem:""},cart:{},coupon_code:""}},methods:{plus(t){t.qty+=1,this.updateCart(t)},minus(t){t.qty>1&&(t.qty-=1,this.updateCart(t))},getProducts(){const t="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,this.products=t.data.products}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){const o=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};this.$http.put(o,{data:a}).then((t=>{this.status.loadingItem="",this.getCart()}))},removeCartItem(t){this.status.loadingItem=t;const o=`https://vue3-course-api.hexschool.io/api/luckypopcorn-api/cart/${t}`;this.isLoading=!0,this.$http.delete(o).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.status.loadingItem="",this.getCart(),this.isLoading=!1}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/luckypopcorn-api/coupon",o={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:o}).then((t=>{this.$httpMessageState(t,"加入優惠券"),this.getCart(),this.isLoading=!1}))}},created(){this.getProducts(),this.getCart()}},D=a(89);const z=(0,D.Z)(L,[["render",I],["__scopeId","data-v-55709c87"]]);var S=z}}]);
//# sourceMappingURL=463.6970e296.js.map